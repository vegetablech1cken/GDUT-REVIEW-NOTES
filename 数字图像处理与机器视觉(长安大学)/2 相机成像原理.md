## 针孔投影模型(小孔成像模型)
相机的成像模型同小孔成像,故一般直接使用小孔成像模型来理解相机成像.
![[Pasted image 20250416160747.png]]
### 透视投影模型
#### 小孔成像坐标转换
![[Pasted image 20250416162103.png]]
右侧是实际物体,左侧是成像屏.
其中$f'$是小孔到成像面的距离,在相机中则是凸透镜的焦距.

根据相似三角形可由实际物体的三维坐标得到投影到成像平面上的三维坐标:
$$(x,y,z)\to(f^{\prime}\frac{x}{z},f^{\prime}\frac{y}{z},f^{\prime})$$
又由于成像平面只需要xy坐标,即得到:
$$(f^{\prime}\frac{x}{z},f^{\prime}\frac{y}{z})$$
#### 齐次坐标
为了顺利表示平移过程,使之是线性变换,也就是说可以用矩阵运算表示(原因参见参考资料1),对于坐标点我们额外添加一个坐标,便是齐次坐标:
$$\begin{aligned}(x,y)&\Rightarrow\begin{bmatrix}x\\y\\1\end{bmatrix}&(x,y,z)\Rightarrow\begin{bmatrix}x\\y\\z\\1\end{bmatrix}\\&\text{齐次图像坐标}&\text{齐次场景坐标}\end{aligned}$$
齐次坐标转化为普通的图像/场景坐标的方法:
$$\begin{bmatrix}x\\y\\w\end{bmatrix}\Rightarrow(x/w,y/w)\quad\begin{bmatrix}x\\y\\z\\w\end{bmatrix}\Rightarrow(x/w,y/w,z/w)$$
所以,通过齐次坐标和矩阵运算实现投影操作的方法如下:
$$\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1/f’&0\end{bmatrix}\begin{bmatrix}x\\y\\z\\1\end{bmatrix}=\begin{bmatrix}x\\y\\z/f’\end{bmatrix}\Rightarrow(f’\frac{x}{z},f’\frac{y}{z})$$
#### 特殊投影形式:正射投影
假如投影中心距离成像平面无穷远($f'\to \infty$),那么就是正射投影.
![[Pasted image 20250416164812.png]]
那么由$f'\to \infty$可知,其投影矩阵为:
$$\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&0&1\end{bmatrix}\begin{bmatrix}x\\y\\z\\1\end{bmatrix}=\begin{bmatrix}x\\y\\1\end{bmatrix}\Rightarrow(x,y)$$

参考资料:
[【相机模型都没弄懂，怎么搞机器人视觉算法？】 ](https://www.bilibili.com/video/BV12u411G71A/?share_source=copy_web&vd_source=34dd435d3d651e8a3a60eacd5873aed9)
## 相机与镜头
### 透镜的作用
透镜可以将光线汇聚到一个焦点上，从而在成像平面上形成清晰的图像,代替了小孔成像模型中小孔的位置.
![[Pasted image 20250416165313.png]]
![[Pasted image 20250416165321.png]]
下图中f是凸透镜焦距.焦距是透镜中心到焦点的距离。焦距越短，视场越大；焦距越长，视场越小.
![[Pasted image 20250416165433.png]]
平行光线通过透镜后会汇聚在焦距处的焦点上.从相似三角形关系可以得到两个式子:$$\begin{aligned}\mathbf{y^{\prime}/y}&=\mathbf{D^{\prime}/D}\\\mathbf{y^{\prime}/y}&=(\mathbf{D^{\prime}-f})/\mathbf{D}\end{aligned}$$
转化一下可以得到薄透镜方程(薄透镜公式):
$$\frac{1}{\mathrm{D^{\prime}}}+\frac{1}{\mathrm{D}}=\frac{1}{\mathrm{f}}$$
满足这个方程的点就是焦点.
### 光圈调节
在上面关于凸透镜作用的讨论中,如果一个物体的点投影后不在成像面上汇聚成点,那么就会形成一个光斑(散光圈):
![[Pasted image 20250416165748.png]]
这个散光圈的大小和相机镜头开孔大小有关,也就是和光圈有关.

光圈是相机镜头中的一个开口，用于控制进入相机的光线量.

**光圈大小的影响**：
- 较大的光圈允许更多的光线进入，适合低光环境，但可能导致较浅的景深。
- 较小的光圈限制光线量，适合明亮环境，但可能导致较深的景深。
### 景深效果
上面讲到的散光圈,产生的就是景深效果.景深就是在焦外的物体成像,产生的模糊像.光圈越大,景深越大.
![[Pasted image 20250416170019.png]]
### 焦平面控制
上面关于相机成像的讨论都是在焦平面平行于图像平面和镜头平面的情况下讨论的,如下图:
![[Pasted image 20250416170221.png]]
如果倾斜镜头,就可以使三者不平行,产生特殊效果:
![[Pasted image 20250416170258.png]]
产生的效果被称为移轴摄影.
### 视野与焦距
视场(视野)是指相机能够捕捉到的场景范围，取决于焦距和传感器尺寸.

焦距越大,传感器尺寸越小,视野越窄;
焦距越小,传感器尺寸越大,视野越宽.

视野的定量计算:
![[Pasted image 20250416170549.png]]
上图中,$\varphi$就是用角度表示的视野,由图有公式:
$$\varphi=\tan^{-1}(\frac{d}{2f})$$
### 镜头缺陷
1. 色差
   不同波长的透镜具有不同的折射率：导致边缘颜色出现偏差
   ![[Pasted image 20250416170805.png]]
2. 球形像差
   球面透镜不能很好地聚焦光线,导致光线离光轴越远焦点越近
   ![[Pasted image 20250416170850.png]]
3. 渐晕
   渐晕是指图像边缘比中心区域暗淡的现象。这种现象通常是由于光线在通过透镜时，某些部分的光线被遮挡或衰减所导致的.
   ![[Pasted image 20250416170926.png]]
4. 径向畸变
   由透镜缺陷引起的图像畸变，常见的有枕形畸变和桶形畸变.
   ![[Pasted image 20250416171835.png]]
## 数码相机
### 传感器类型
数码相机利用传感器阵列取代屏幕.
数组中的每一个细胞都是光敏二极管，将光子转换为电子.

数码相机的传感器有两种最常见的材料,分别是电荷耦合器件(CCD)和互补金属氧化物半导体(CMOS).
#### CCD
通过芯片传输电荷，在每一个角落都能读到它。然后模拟-数字转换器（ADC）通过测量每个光点的电荷量并将测量值转换为二进制形式，将每个像素的值转换为数字值。
#### CMOS
在每个像素上使用几个晶体管，用更传统的电线来放大和移动电荷。CMOS信号是数字信号，因此不需要ADC。
![[Pasted image 20250416172454.png]]
### 颜色感知
彩色摄像机需要放置红绿蓝三种颜色的传感器,有下面常见几种方法:
#### 拜尔滤镜阵列
下图是拜尔网络.
![[Pasted image 20250416172728.png]]
由于绿色传感器比红蓝传感器多一倍,所以产生的图像可能出现偏绿的情况.还有可能出现颜色波纹问题.
#### 棱镜分光
使用棱镜分光的色彩感知原理如下图.
![[Pasted image 20250416172908.png]]
每个像素都需要三个芯片采集各自颜色,所以这个方法更加昂贵.
#### Foveon X3传感器
利用了红色,蓝色和绿色的光穿透硅不同深度,再进行采集颜色.
![[Pasted image 20250416173006.png]]
![[Pasted image 20250416173010.png]]
